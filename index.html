<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒ∞ngilizce √áalƒ±≈üma Planlayƒ±cƒ±sƒ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f6fa;
            color: #333;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .btn-primary {
            background: #4a90e2;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-outline {
            background: white;
            border: 2px solid #4a90e2;
            color: #4a90e2;
        }

        .json-section {
            margin-top: 20px;
        }

        .json-input {
            width: 100%;
            height: 400px;
            padding: 15px;
            font-family: 'Consolas', monospace;
            font-size: 14px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin: 15px 0;
            resize: vertical;
        }

        .error-message {
            color: #dc3545;
            background: #fff5f5;
            padding: 12px;
            border-radius: 6px;
            margin: 10px 0;
            display: none;
        }

        .success-message {
            color: #28a745;
            background: #f0fff4;
            padding: 12px;
            border-radius: 6px;
            margin: 10px 0;
            display: none;
        }

        .preview-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
            }

            .button-group {
                flex-wrap: wrap;
                justify-content: center;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }
		
			.preview-section {
			margin-top: 30px;
			padding: 20px;
			background: white;
			border-radius: 8px;
			box-shadow: 0 2px 4px rgba(0,0,0,0.1);
		}

		.topics-preview {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 20px;
			margin-bottom: 20px;
		}

		.day-preview {
			background: #f8f9fa;
			padding: 15px;
			margin: 10px 0;
			border-radius: 6px;
		}

		.time-block-preview {
			margin: 10px 0;
			padding: 10px;
			background: white;
			border-radius: 4px;
		}

		.time-block-preview ul {
			list-style: none;
			padding-left: 20px;
		}

		.time-block-preview li {
			margin: 5px 0;
			padding: 5px;
			border-left: 3px solid #4a90e2;
		}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ƒ∞ngilizce √áalƒ±≈üma Planlayƒ±cƒ±sƒ±</h1>
            <div class="button-group">
                <button class="btn btn-outline" onclick="showExamplePlan()">
                    üìã √ñrnek Plan
                </button>
                <button class="btn btn-success" onclick="exportToExcel()">
                    üìä Excel'e Aktar
                </button>
                <button class="btn btn-primary" onclick="exportToCalendar()">
                    üìÖ Takvime Ekle
                </button>
            </div>
        </div>

        <div class="json-section">
            <h3>Plan JSON'ƒ±</h3>
            <textarea id="jsonInput" class="json-input" 
                placeholder="JSON formatƒ±ndaki planƒ±nƒ±zƒ± buraya yapƒ±≈ütƒ±rƒ±n..."></textarea>
            <div id="errorMessage" class="error-message"></div>
            <div id="successMessage" class="success-message"></div>
            <div class="button-group">
                <button class="btn btn-outline" onclick="clearPlan()">
                    üóëÔ∏è Temizle
                </button>
                <button class="btn btn-primary" onclick="loadAndValidateJSON()">
                    üì• Planƒ± Y√ºkle
                </button>
            </div>
        </div>
    </div>
	
		<div class="preview-section" id="planPreview">
		<h3>Haftalƒ±k Plan G√∂r√ºn√ºm√º</h3>
		<div class="topics-preview">
			<div class="grammar-topics">
				<h4>üìö Grammar Konularƒ±</h4>
				<ul id="grammarList"></ul>
			</div>
			<div class="goals-topics">
				<h4>üéØ Hedefler</h4>
				<ul id="goalsList"></ul>
			</div>
		</div>
		<div class="schedule-preview" id="schedulePreview"></div>
	</div>

    <script>
        function showExamplePlan() {
            const examplePlan = {
                "weekOf": "2024-01-15",
                "topics": {
                    "grammar": [
                        "Present Perfect",
                        "Since/For Usage",
                        "Already/Yet/Just"
                    ],
                    "goals": [
                        "30 yeni kelime",
                        "2 Modern Family b√∂l√ºm√º",
                        "3 speaking practice"
                    ]
                },
                "days": {
                    "monday": {
                        "morning": [
                            {
                                "task": "BBC Learning English - Present Perfect",
                                "duration": "15dk"
                            }
                        ],
                        "noon": [
                            {
                                "task": "Modern Family B√∂l√ºm 1",
                                "duration": "25dk"
                            }
                        ],
                        "evening": [
                            {
                                "task": "Quizlet √áalƒ±≈ümasƒ±",
                                "duration": "15dk"
                            }
                        ]
                    }
                }
            };
            document.getElementById('jsonInput').value = JSON.stringify(examplePlan, null, 2);
        }

		function loadAndValidateJSON() {
			const jsonInput = document.getElementById('jsonInput').value;
			const errorMessage = document.getElementById('errorMessage');
			const successMessage = document.getElementById('successMessage');
			
			try {
				const planData = JSON.parse(jsonInput);
				errorMessage.style.display = 'none';
				successMessage.textContent = 'Plan ba≈üarƒ±yla y√ºklendi!';
				successMessage.style.display = 'block';
				
				// Plan g√∂r√ºnt√ºleme
				displayPlan(planData);
				
				return planData;
			} catch (e) {
				successMessage.style.display = 'none';
				errorMessage.textContent = 'JSON format hatasƒ±: ' + e.message;
				errorMessage.style.display = 'block';
				return null;
			}
		}

		function displayPlan(plan) {
			// Grammar konularƒ±nƒ± g√∂r√ºnt√ºle
			const grammarList = document.getElementById('grammarList');
			grammarList.innerHTML = plan.topics?.grammar?.map(topic => 
				`<li>${topic}</li>`).join('') || '';

			// Hedefleri g√∂r√ºnt√ºle
			const goalsList = document.getElementById('goalsList');
			goalsList.innerHTML = plan.topics?.goals?.map(goal => 
				`<li>${goal}</li>`).join('') || '';

			// Programƒ± g√∂r√ºnt√ºle
			const schedulePreview = document.getElementById('schedulePreview');
			schedulePreview.innerHTML = Object.entries(plan.days).map(([day, schedule]) => `
				<div class="day-preview">
					<h4>${getDayName(day)}</h4>
					${Object.entries(schedule).map(([timeBlock, tasks]) => `
						<div class="time-block-preview">
							<h5>${getTimeBlockName(timeBlock)}</h5>
							<ul>
								${tasks.map(task => 
									`<li>${task.task} (${task.duration})</li>`
								).join('')}
							</ul>
						</div>
					`).join('')}
				</div>
			`).join('');
		}

		function getDayName(day) {
			const days = {
				monday: 'Pazartesi',
				tuesday: 'Salƒ±',
				wednesday: '√áar≈üamba',
				thursday: 'Per≈üembe',
				friday: 'Cuma'
			};
			return days[day] || day;
		}

		function getTimeBlockName(block) {
			const blocks = {
				morning: 'Sabah',
				noon: '√ñƒüle',
				evening: 'Ak≈üam'
			};
			return blocks[block] || block;
		}

        function exportToExcel() {
            const planData = loadAndValidateJSON();
            if (!planData) return;

            let csv = 'Zaman,Pazartesi,Salƒ±,√áar≈üamba,Per≈üembe,Cuma\n';
            const timeBlocks = ['morning', 'noon', 'evening'];
            const timeNames = ['Sabah', '√ñƒüle', 'Ak≈üam'];
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
            
            timeBlocks.forEach((block, index) => {
                let row = [timeNames[index]];
                days.forEach(day => {
                    const tasks = planData.days[day]?.[block] || [];
                    const taskText = tasks.map(t => `${t.task} (${t.duration})`).join('\n');
                    row.push('"' + taskText + '"');
                });
                csv += row.join(',') + '\n';
            });

            downloadCSV(csv, `ingilizce_plan_${planData.weekOf}.csv`);
        }

        function downloadCSV(csv, filename) {
            const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function exportToCalendar() {
            const planData = loadAndValidateJSON();
            if (!planData) return;

            const startDate = new Date(planData.weekOf);
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
            const timeBlocks = {
                'morning': '09:00',
                'noon': '12:00',
                'evening': '17:00'
            };

            days.forEach((day, dayIndex) => {
                const date = new Date(startDate);
                date.setDate(date.getDate() + dayIndex);

                Object.entries(planData.days[day] || {}).forEach(([block, tasks]) => {
                    tasks.forEach(task => {
                        const startTime = timeBlocks[block];
                        const eventTitle = `${task.task} (${task.duration})`;
                        const calendarUrl = createGoogleCalendarURL(date, startTime, eventTitle);
                        window.open(calendarUrl, '_blank');
                    });
                });
            });
        }

        function createGoogleCalendarURL(date, time, title) {
            const dateString = date.toISOString().split('T')[0].replace(/-/g, '');
            const timeString = time.replace(':', '');
            const dateTimeString = `${dateString}T${timeString}00/${dateString}T${timeString}00`;
            
            return `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&dates=${dateTimeString}`;
        }

        function clearPlan() {
            document.getElementById('jsonInput').value = '';
            document.getElementById('errorMessage').style.display = 'none';
            document.getElementById('successMessage').style.display = 'none';
        }
    </script>
</body>
</html>
